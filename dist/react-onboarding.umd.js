!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t(e.onboarding={},e.react)}(this,function(e,t){var n=function(){var e={};function t(t){e[t]||(e[t]={})}return{tree:e,setStep:t,setField:function(n,r){void 0===e[r]&&t(r),e[r][n]||(e[r][n]="")},setFieldValue:function(t,n,r){void 0!==e[n]&&void 0!==e[n][t]&&(e[n][t]=r)},getFieldValue:function(t,n){return void 0===e[n]||void 0===e[n][t]?"":e[n][t]}}}(),r="STEP",o="FIELD",i="END";function s(e,t){return e.type.__type!==o?e:Object.assign({},e,{key:e.props.name,props:Object.assign({},e.props,{__enhancements:t})})}var p=t.createContext({}),a=p.Provider,c=p.Consumer,u=function(e){function o(n){var o=this;e.call(this,n),this.nextStep=function(){o.state.currentStep+1>=o.numberOfSteps||o.setState(function(e){return Object.assign({},e,{currentStep:e.currentStep+1})})},this.prevStep=function(){o.state.currentStep-1<0||o.setState(function(e){return Object.assign({},e,{currentStep:e.currentStep-1})})},this.onboardingRenderer=function(){var e=o.props,n=e.finished,s=o.state.currentStep,p=0,a=!1;return t.Children.map(e.children,function(e,t){if(e){var c,u=e.type.__type;if(!u)return e;if(n||u!==i)return n||u===i||u===r?n||u!==r?n&&u!==r?e:void 0:p!==s||a?void(p+=1):(a=!0,(c=e).type.__type!==r?c:Object.assign({},c,{key:c.props.name,props:Object.assign({},c.props,{__enhancements:{nextStep:o.nextStep,prevStep:o.prevStep}})})):e}})},this.state={initialStep:n.initialStep||0,currentStep:n.initialStep||0},this.numberOfSteps=t.Children.map(n.children,function(e){if(e.type.__type===r)return e}).length,console.log(this.numberOfSteps)}return e&&(o.__proto__=e),(o.prototype=Object.create(e&&e.prototype)).constructor=o,o.prototype.shouldComponentUpdate=function(e,t){return this.state.currentStep!==t.currentStep||this.props.finished!==e.finished},o.prototype.render=function(){return t.createElement(a,{value:{numberOfSteps:this.numberOfSteps,currentStep:this.state.currentStep+1,onboarding:n.tree,prevStep:this.prevStep,nextStep:this.nextStep}},this.onboardingRenderer())},o}(t.Component);function l(e){return e.replace(/-/gi,"_")}var d=function(e){function t(t){var r=this;e.call(this,t),this.setValidStep=function(e){return r.setState({validStep:e})},this.setProcessed=function(e){return r.setState({processed:e})},this.stepRenderer=function(){var e=r.props,t=e.name,n=e.__enhancements,o=r.state,i=o.processed,p=(0,e.children)({nextStep:i?n.nextStep:function(){return null},prevStep:n.prevStep||function(){return null},validStep:!(!o.validStep||!i)});return Array.isArray(p.props.children)?Object.assign({},p,{props:{children:p.props.children.map(function(e){return s(e,{step:l(t),setValidStep:r.setValidStep,setProcessed:r.setProcessed})})}}):Object.assign({},p,{props:{children:s(p.props.children,{step:l(t),setValidStep:r.setValidStep,setProcessed:r.setProcessed})}})};var o=l(t.name);n.setStep(o),this.state={validStep:!0,processed:!!t.conversational}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.componentDidMount=function(){this.props.children({nextStep:function(){},prevStep:function(){},validStep:!0}).props.children.some(function(e){return e.props.validations})||this.setState({processed:!0})},t.prototype.render=function(){return this.stepRenderer()},t}(t.Component);d.__type=r;var f=function(e){function t(t){var r=this;e.call(this,t),this.onChange=function(e){r.setState(function(){return{valid:!0,error:null}},function(){var t=r.props.__enhancements.setProcessed;n.setFieldValue(r.snaked_name,r.step,e),r.setState({value:e});var o=r.props.validations;if(void 0===o&&(o=[]),0!==o.length){var i=o.filter(function(e){return"change"===e.on});if(i)for(var s=!1,p=0;p<i.length&&!s;p++){var a=r.props.__enhancements.setValidStep,c=i[p].validator(e);c||(r.setState({valid:!1,error:i[p].errorMessage}),s=!0),a(c)}}t(!0)})},this.onFocus=function(){r.setState(function(){return{valid:!0,error:null}},function(){var e=r.state.value,t=r.props.validations;if(void 0===t&&(t=[]),0!==t.length){var n=t.filter(function(e){return"focus"===e.on});if(n)for(var o=!1,i=0;i<n.length&&!o;i++){var s=r.props.__enhancements.setValidStep,p=n[i].validator(e);p||(r.setState({valid:!1,error:n[i].errorMessage}),o=!0),s(p)}}})},this.onBlur=function(){r.setState(function(){return{valid:!0,error:null}},function(){var e=r.state.value,t=r.props.validations;if(void 0===t&&(t=[]),0!==t.length){var n=t.filter(function(e){return"blur"===e.on});if(n)for(var o=!1,i=0;i<n.length&&!o;i++){var s=r.props.__enhancements.setValidStep,p=n[i].validator(e);p||(r.setState({valid:!1,error:n[i].errorMessage}),o=!0),s(p)}}})};var o=this.props.__enhancements.step;this.snaked_name=l(t.name),this.step=o,n.setField(this.snaked_name,o),this.state={value:n.getFieldValue(this.snaked_name,o),valid:!0,error:null}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.render=function(){var e=this.props,t=this.state;return(0,e.children)({value:t.value,type:e.type,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,error:t.error,valid:t.valid})},t}(t.Component);f.__type=o;var h=function(e){function t(){e.apply(this,arguments),this.state={tree:Object.assign({},n.tree)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.render=function(){return(0,this.props.children)(this.state.tree)},t}(t.Component);h.__type=i,e.Onboarding=u,e.Info=c,e.Step=d,e.Field=f,e.End=h});
//# sourceMappingURL=react-onboarding.umd.js.map
