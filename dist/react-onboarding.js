var e=require("react"),t=function(){var e={};function t(t){e[t]||(e[t]={})}return{tree:e,setStep:t,setField:function(r,n){void 0===e[n]&&t(n),e[n][r]||(e[n][r]="")},setFieldValue:function(t,r,n){void 0!==e[r]&&void 0!==e[r][t]&&(e[r][t]=n)},getFieldValue:function(t,r){return void 0===e[r]||void 0===e[r][t]?"":e[r][t]}}}(),r="STEP",n="FIELD",o="END";function s(e,t){return e.type.__type!==n?e:Object.assign({},e,{key:e.props.name,props:Object.assign({},e.props,{__enhancements:t})})}var i=e.createContext({}),p=i.Provider,a=i.Consumer,c=function(n){function s(t){var s=this;n.call(this,t),this.nextStep=function(){s.state.currentStep+1>=s.numberOfSteps||s.setState(function(e){return Object.assign({},e,{currentStep:e.currentStep+1})})},this.prevStep=function(){s.state.currentStep-1<0||s.setState(function(e){return Object.assign({},e,{currentStep:e.currentStep-1})})},this.onboardingRenderer=function(){var t=s.props,n=t.finished,i=s.state.currentStep,p=0,a=!1;return e.Children.map(t.children,function(e,t){if(e){var c,u=e.type.__type;if(!u)return e;if(n||u!==o)return n||u===o||u===r?n||u!==r?n&&u!==r?e:void 0:p!==i||a?void(p+=1):(a=!0,(c=e).type.__type!==r?c:Object.assign({},c,{key:c.props.name,props:Object.assign({},c.props,{__enhancements:{nextStep:s.nextStep,prevStep:s.prevStep}})})):e}})},this.state={initialStep:t.initialStep||0,currentStep:t.initialStep||0},this.numberOfSteps=e.Children.map(t.children,function(e){if(e.type.__type===r)return e}).length,console.log(this.numberOfSteps)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.shouldComponentUpdate=function(e,t){return this.state.currentStep!==t.currentStep||this.props.finished!==e.finished},s.prototype.render=function(){return e.createElement(p,{value:{numberOfSteps:this.numberOfSteps,currentStep:this.state.currentStep+1,onboarding:t.tree,prevStep:this.prevStep,nextStep:this.nextStep}},this.onboardingRenderer())},s}(e.Component);function u(e){return e.replace(/-/gi,"_")}var l=function(e){function r(r){var n=this;e.call(this,r),this.setValidStep=function(e){return n.setState({validStep:e})},this.setProcessed=function(e){return n.setState({processed:e})},this.stepRenderer=function(){var e=n.props,t=e.name,r=e.__enhancements,o=n.state,i=o.processed,p=(0,e.children)({nextStep:i?r.nextStep:function(){return null},prevStep:r.prevStep||function(){return null},validStep:!(!o.validStep||!i)});return Array.isArray(p.props.children)?Object.assign({},p,{props:{children:p.props.children.map(function(e){return s(e,{step:u(t),setValidStep:n.setValidStep,setProcessed:n.setProcessed})})}}):Object.assign({},p,{props:{children:s(p.props.children,{step:u(t),setValidStep:n.setValidStep,setProcessed:n.setProcessed})}})};var o=u(r.name);t.setStep(o),this.state={validStep:!0,processed:!!r.conversational}}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.componentDidMount=function(){this.props.children({nextStep:function(){},prevStep:function(){},validStep:!0}).props.children.some(function(e){return e.props.validations})||this.setState({processed:!0})},r.prototype.render=function(){return this.stepRenderer()},r}(e.Component);l.__type=r;var d=function(e){function r(r){var n=this;e.call(this,r),this.onChange=function(e){n.setState(function(){return{valid:!0,error:null}},function(){var r=n.props.__enhancements.setProcessed;t.setFieldValue(n.snaked_name,n.step,e),n.setState({value:e});var o=n.props.validations;if(void 0===o&&(o=[]),0!==o.length){var s=o.filter(function(e){return"change"===e.on});if(s)for(var i=!1,p=0;p<s.length&&!i;p++){var a=n.props.__enhancements.setValidStep,c=s[p].validator(e);c||(n.setState({valid:!1,error:s[p].errorMessage}),i=!0),a(c)}}r(!0)})},this.onFocus=function(){n.setState(function(){return{valid:!0,error:null}},function(){var e=n.state.value,t=n.props.validations;if(void 0===t&&(t=[]),0!==t.length){var r=t.filter(function(e){return"focus"===e.on});if(r)for(var o=!1,s=0;s<r.length&&!o;s++){var i=n.props.__enhancements.setValidStep,p=r[s].validator(e);p||(n.setState({valid:!1,error:r[s].errorMessage}),o=!0),i(p)}}})},this.onBlur=function(){n.setState(function(){return{valid:!0,error:null}},function(){var e=n.state.value,t=n.props.validations;if(void 0===t&&(t=[]),0!==t.length){var r=t.filter(function(e){return"blur"===e.on});if(r)for(var o=!1,s=0;s<r.length&&!o;s++){var i=n.props.__enhancements.setValidStep,p=r[s].validator(e);p||(n.setState({valid:!1,error:r[s].errorMessage}),o=!0),i(p)}}})};var o=this.props.__enhancements.step;this.snaked_name=u(r.name),this.step=o,t.setField(this.snaked_name,o),this.state={value:t.getFieldValue(this.snaked_name,o),valid:!0,error:null}}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.render=function(){var e=this.props,t=this.state;return(0,e.children)({value:t.value,type:e.type,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,error:t.error,valid:t.valid})},r}(e.Component);d.__type=n;var h=function(e){function r(){e.apply(this,arguments),this.state={tree:Object.assign({},t.tree)}}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.render=function(){return(0,this.props.children)(this.state.tree)},r}(e.Component);h.__type=o,exports.Onboarding=c,exports.Info=a,exports.Step=l,exports.Field=d,exports.End=h;
//# sourceMappingURL=react-onboarding.js.map
